> setwd("D:/APU/APU-main/Lab3")
> install.packages("neuralnet")
Error in install.packages : Updating loaded packages
> library(neuralnet)
> 
> normalize <- function(x) {
+   return ((x-min(x)) / (max(x) - min(x)))
+ }
> 
> Input <-  as.data.frame(runif(100, min=1, max=100))
> #f(x) = x^3 - 2x
> Output <- Input^3 - 2*Input
> 
> data <- cbind(Input,Output)
> colnames(data) <- c("Input","Output")
> # dane musza zostac znormalizowane
> normalized <- as.data.frame(lapply(data, normalize))
> 
> #podzial danych
> traindata <- normalized[1:85,]
> testdata <- normalized[86:100,]
> 
> #neuralnet -trenowanie
> nn <- neuralnet(Output ~ Input, data=traindata, hidden=10, threshold=0.01, linear.output=TRUE)
> print(nn)
$call
neuralnet(formula = Output ~ Input, data = traindata, hidden = 10, 
    threshold = 0.01, linear.output = TRUE)

$response
         Output
1  4.831320e-03
2  7.846347e-01
3  6.512986e-01
4  6.347425e-02
5  4.922014e-02
6  6.790715e-01
7  2.779270e-02
8  2.263268e-01
9  1.355954e-02
10 5.457770e-01
11 5.427527e-01
12 1.261677e-03
13 3.550348e-03
14 7.401862e-02
15 1.002373e-01
16 1.029563e-02
17 6.381799e-01
18 1.873071e-01
19 4.612487e-01
20 9.648721e-02
21 3.696814e-02
22 2.838608e-01
23 1.005214e-01
24 1.470223e-03
25 1.721268e-01
26 4.596845e-02
27 3.967502e-01
28 7.866222e-01
29 4.804891e-01
30 8.141389e-01
31 2.757795e-01
32 1.315735e-01
33 3.126225e-01
34 7.305165e-01
35 7.496758e-01
36 8.030325e-02
37 2.419517e-01
38 4.691943e-02
39 1.865946e-03
40 2.903835e-01
41 1.004173e-01
42 1.904291e-01
43 0.000000e+00
44 5.384101e-03
45 4.088112e-02
46 5.932299e-01
47 2.127895e-02
48 1.795307e-06
49 5.856943e-01
50 2.692459e-02
51 8.682875e-03
52 7.298979e-02
53 1.775528e-02
54 2.722195e-03
55 3.439846e-01
56 3.735150e-02
57 8.713573e-03
58 2.243017e-04
59 7.737540e-02
60 4.092019e-01
61 3.247375e-02
62 3.151396e-01
63 8.117759e-02
64 8.488574e-03
65 2.341014e-02
66 1.142232e-01
67 7.776079e-02
68 1.668661e-01
69 3.867927e-02
70 3.631255e-03
71 1.496508e-01
72 2.370261e-01
73 2.025988e-04
74 3.512430e-03
75 3.659662e-02
76 6.194245e-03
77 5.578395e-02
78 2.991863e-01
79 4.611534e-01
80 4.453043e-04
81 6.306941e-01
82 2.416123e-01
83 1.663471e-01
84 1.201254e-01
85 4.649708e-03

$covariate
                 
 [1,] 0.154565902
 [2,] 0.920954236
 [3,] 0.864446705
 [4,] 0.388268622
 [5,] 0.355281386
 [6,] 0.876812576
 [7,] 0.290617074
 [8,] 0.602479712
 [9,] 0.225083343
[10,] 0.813968753
[11,] 0.812429598
[12,] 0.092741840
[13,] 0.137821676
[14,] 0.409601413
[15,] 0.455039724
[16,] 0.203825951
[17,] 0.858483098
[18,] 0.564569083
[19,] 0.768600445
[20,] 0.449070179
[21,] 0.321354062
[22,] 0.651118271
[23,] 0.455485899
[24,] 0.098458647
[25,] 0.548394330
[26,] 0.346883521
[27,] 0.730092467
[28,] 0.921746192
[29,] 0.779385827
[30,] 0.932576091
[31,] 0.644709919
[32,] 0.499903884
[33,] 0.672985373
[34,] 0.898855751
[35,] 0.906800289
[36,] 0.421365238
[37,] 0.616435289
[38,] 0.349379421
[39,] 0.107976069
[40,] 0.656202506
[41,] 0.455322566
[42,] 0.567786272
[43,] 0.000000000
[44,] 0.160877042
[45,] 0.332911466
[46,] 0.837407320
[47,] 0.264379638
[48,] 0.002161633
[49,] 0.833770890
[50,] 0.287375503
[51,] 0.191621542
[52,] 0.407612876
[53,] 0.247878606
[54,] 0.124711991
[55,] 0.695350890
[56,] 0.322521361
[57,] 0.191867370
[58,] 0.045211606
[59,] 0.415964123
[60,] 0.737835464
[61,] 0.307024770
[62,] 0.674834196
[63,] 0.422952671
[64,] 0.190052003
[65,] 0.273489932
[66,] 0.476073837
[67,] 0.416682764
[68,] 0.542567495
[69,] 0.326503685
[70,] 0.138988566
[71,] 0.522597718
[72,] 0.612102530
[73,] 0.043199692
[74,] 0.137268711
[75,] 0.320215082
[76,] 0.169390520
[77,] 0.371168172
[78,] 0.662944720
[79,] 0.768546303
[80,] 0.060801572
[81,] 0.855043471
[82,] 0.616138622
[83,] 0.541986108
[84,] 0.484435403
[85,] 0.152388020

$model.list
$model.list$response
[1] "Output"

$model.list$variables
[1] "Input"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
<bytecode: 0x0000012dc9a37478>
<environment: 0x0000012dc8ade558>
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
<bytecode: 0x0000012dc9a1eb68>
<environment: 0x0000012dc8adead0>
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
         Input       Output
1  0.154565902 4.831320e-03
2  0.920954236 7.846347e-01
3  0.864446705 6.512986e-01
4  0.388268622 6.347425e-02
5  0.355281386 4.922014e-02
6  0.876812576 6.790715e-01
7  0.290617074 2.779270e-02
8  0.602479712 2.263268e-01
9  0.225083343 1.355954e-02
10 0.813968753 5.457770e-01
11 0.812429598 5.427527e-01
12 0.092741840 1.261677e-03
13 0.137821676 3.550348e-03
14 0.409601413 7.401862e-02
15 0.455039724 1.002373e-01
16 0.203825951 1.029563e-02
17 0.858483098 6.381799e-01
18 0.564569083 1.873071e-01
19 0.768600445 4.612487e-01
20 0.449070179 9.648721e-02
21 0.321354062 3.696814e-02
22 0.651118271 2.838608e-01
23 0.455485899 1.005214e-01
24 0.098458647 1.470223e-03
25 0.548394330 1.721268e-01
26 0.346883521 4.596845e-02
27 0.730092467 3.967502e-01
28 0.921746192 7.866222e-01
29 0.779385827 4.804891e-01
30 0.932576091 8.141389e-01
31 0.644709919 2.757795e-01
32 0.499903884 1.315735e-01
33 0.672985373 3.126225e-01
34 0.898855751 7.305165e-01
35 0.906800289 7.496758e-01
36 0.421365238 8.030325e-02
37 0.616435289 2.419517e-01
38 0.349379421 4.691943e-02
39 0.107976069 1.865946e-03
40 0.656202506 2.903835e-01
41 0.455322566 1.004173e-01
42 0.567786272 1.904291e-01
43 0.000000000 0.000000e+00
44 0.160877042 5.384101e-03
45 0.332911466 4.088112e-02
46 0.837407320 5.932299e-01
47 0.264379638 2.127895e-02
48 0.002161633 1.795307e-06
49 0.833770890 5.856943e-01
50 0.287375503 2.692459e-02
51 0.191621542 8.682875e-03
52 0.407612876 7.298979e-02
53 0.247878606 1.775528e-02
54 0.124711991 2.722195e-03
55 0.695350890 3.439846e-01
56 0.322521361 3.735150e-02
57 0.191867370 8.713573e-03
58 0.045211606 2.243017e-04
59 0.415964123 7.737540e-02
60 0.737835464 4.092019e-01
61 0.307024770 3.247375e-02
62 0.674834196 3.151396e-01
63 0.422952671 8.117759e-02
64 0.190052003 8.488574e-03
65 0.273489932 2.341014e-02
66 0.476073837 1.142232e-01
67 0.416682764 7.776079e-02
68 0.542567495 1.668661e-01
69 0.326503685 3.867927e-02
70 0.138988566 3.631255e-03
71 0.522597718 1.496508e-01
72 0.612102530 2.370261e-01
73 0.043199692 2.025988e-04
74 0.137268711 3.512430e-03
75 0.320215082 3.659662e-02
76 0.169390520 6.194245e-03
77 0.371168172 5.578395e-02
78 0.662944720 2.991863e-01
79 0.768546303 4.611534e-01
80 0.060801572 4.453043e-04
81 0.855043471 6.306941e-01
82 0.616138622 2.416123e-01
83 0.541986108 1.663471e-01
84 0.484435403 1.201254e-01
85 0.152388020 4.649708e-03

$exclude
NULL

$net.result
$net.result[[1]]
             [,1]
 [1,] 0.004385530
 [2,] 0.764050486
 [3,] 0.652784916
 [4,] 0.060552294
 [5,] 0.045933149
 [6,] 0.677148157
 [7,] 0.024453214
 [8,] 0.229443019
 [9,] 0.011162274
[10,] 0.555032211
[11,] 0.552120578
[12,] 0.002832918
[13,] 0.003649915
[14,] 0.071433804
[15,] 0.098587880
[16,] 0.008404210
[17,] 0.641068539
[18,] 0.188913315
[19,] 0.471776302
[20,] 0.094699965
[21,] 0.033535396
[22,] 0.289278777
[23,] 0.098882475
[24,] 0.002860617
[25,] 0.173158418
[26,] 0.042622382
[27,] 0.406190448
[28,] 0.765598265
[29,] 0.491039485
[30,] 0.786690053
[31,] 0.280872280
[32,] 0.131088559
[33,] 0.319184562
[34,] 0.720644737
[35,] 0.736289464
[36,] 0.077934114
[37,] 0.245686768
[38,] 0.043589399
[39,] 0.002949390
[40,] 0.296063238
[41,] 0.098774566
[42,] 0.192154278
[43,] 0.003636895
[44,] 0.004737432
[45,] 0.037469829
[46,] 0.599953541
[47,] 0.018196958
[48,] 0.003618310
[49,] 0.592919803
[50,] 0.023608005
[51,] 0.007118588
[52,] 0.070370525
[53,] 0.014918546
[54,] 0.003255106
[55,] 0.351735180
[56,] 0.033919552
[57,] 0.007142459
[58,] 0.003115564
[59,] 0.074904764
[60,] 0.418953625
[61,] 0.029056831
[62,] 0.321800002
[63,] 0.078839067
[64,] 0.006968094
[65,] 0.020220115
[66,] 0.113092101
[67,] 0.075303419
[68,] 0.167699752
[69,] 0.035252373
[70,] 0.003692404
[71,] 0.149839996
[72,] 0.240565351
[73,] 0.003139705
[74,] 0.003630216
[75,] 0.033163395
[76,] 0.005282294
[77,] 0.052647339
[78,] 0.305217627
[79,] 0.471680527
[80,] 0.002949291
[81,] 0.634324436
[82,] 0.245333838
[83,] 0.167161313
[84,] 0.119213974
[85,] 0.004273947


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]       [,2]       [,3]      [,4]      [,5]       [,6]      [,7]      [,8]
[1,] -0.8542559  0.2653795  0.7101557 -1.860480  6.648004 0.78659975 0.9720323  1.631339
[2,] -0.8765076 -3.9342955 -1.2705141  1.300512 -7.625763 0.05791315 0.4069146 -2.165054
          [,9]      [,10]
[1,]  1.472976 -1.0073296
[2,] -0.797817 -0.4830262

$weights[[1]][[2]]
            [,1]
 [1,] -0.2778150
 [2,] -1.6290737
 [3,]  1.0959406
 [4,] -0.7473670
 [5,]  0.3876414
 [6,] -0.5284614
 [7,]  2.5012916
 [8,]  1.2546861
 [9,] -0.4042159
[10,] -1.1229361
[11,] -0.9464363



$generalized.weights
$generalized.weights[[1]]
           [,1]
 [1,] 11.995689
 [2,] 10.843283
 [3,]  8.677640
 [4,]  8.495217
 [5,]  9.217698
 [6,]  9.023660
 [7,] 11.065232
 [8,]  6.436105
 [9,] 13.236343
[10,]  7.666503
[11,]  7.643050
[12,]  1.164635
[13,]  9.865277
[14,]  8.099810
[15,]  7.422674
[16,] 13.670956
[17,]  8.527858
[18,]  6.538095
[19,]  7.098782
[20,]  7.499820
[21,] 10.115060
[22,]  6.441712
[23,]  7.417043
[24,]  2.260556
[25,]  6.611308
[26,]  9.424781
[27,]  6.774316
[28,] 10.888085
[29,]  7.213043
[30,] 11.564535
[31,]  6.432394
[32,]  6.945069
[33,]  6.493049
[34,]  9.791601
[35,] 10.130254
[36,]  7.903901
[37,]  6.422294
[38,]  9.362216
[39,]  4.195666
[40,]  6.450948
[41,]  7.419103
[42,]  6.525694
[43,] -2.295034
[44,] 12.554621
[45,]  9.791146
[46,]  8.070825
[47,] 11.955728
[48,] -2.461058
[49,]  8.001737
[50,] 11.172210
[51,] 13.715206
[52,]  8.134440
[53,] 12.523311
[54,]  7.581553
[55,]  6.577197
[56,] 10.081488
[57,] 13.716408
[58,] -3.828837
[59,]  7.991967
[60,]  6.829998
[61,] 10.542609
[62,]  6.498782
[63,]  7.878614
[64,] 13.705210
[65,] 11.641415
[66,]  7.177002
[67,]  7.980067
[68,]  6.642199
[69,]  9.968399
[70,] 10.044175
[71,]  6.766799
[72,]  6.425241
[73,] -3.866132
[74,]  9.778982
[75,] 10.148003
[76,] 13.113186
[77,]  8.852108
[78,]  6.465715
[79,]  7.098237
[80,] -3.090250
[81,]  8.445949
[82,]  6.422457
[83,]  6.645415
[84,]  7.090193
[85,] 11.772347


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]       [,2]       [,3]        [,4]      [,5]        [,6]      [,7]        [,8]
[1,] -0.9624389  0.2376528  0.6598145 -1.77782891  1.262601  0.83673899 1.0546934  1.54868389
[2,] -1.0227633 -2.3057742 -1.1197175 -0.02575692 -2.605211 -0.09851121 0.2593647 -0.06992216
             [,9]      [,10]
[1,]  1.390325373 -1.0899908
[2,] -0.003548616 -0.3567516

$startweights[[1]][[2]]
             [,1]
 [1,] -0.19516401
 [2,] -1.52263274
 [3,]  0.37043618
 [4,] -0.63918410
 [5,]  0.47028287
 [6,]  0.08893165
 [7,]  2.58394258
 [8,]  1.30482528
 [9,] -0.32154249
[10,] -1.04028510
[11,] -0.86378530



$result.matrix
                                [,1]
error                    0.001668229
reached.threshold        0.008633562
steps                  450.000000000
Intercept.to.1layhid1   -0.854255927
Input.to.1layhid1       -0.876507607
Intercept.to.1layhid2    0.265379542
Input.to.1layhid2       -3.934295457
Intercept.to.1layhid3    0.710155665
Input.to.1layhid3       -1.270514150
Intercept.to.1layhid4   -1.860479874
Input.to.1layhid4        1.300512473
Intercept.to.1layhid5    6.648004029
Input.to.1layhid5       -7.625763380
Intercept.to.1layhid6    0.786599750
Input.to.1layhid6        0.057913151
Intercept.to.1layhid7    0.972032256
Input.to.1layhid7        0.406914615
Intercept.to.1layhid8    1.631339151
Input.to.1layhid8       -2.165054176
Intercept.to.1layhid9    1.472976347
Input.to.1layhid9       -0.797816963
Intercept.to.1layhid10  -1.007329560
Input.to.1layhid10      -0.483026195
Intercept.to.Output     -0.277815008
1layhid1.to.Output      -1.629073724
1layhid2.to.Output       1.095940565
1layhid3.to.Output      -0.747367045
1layhid4.to.Output       0.387641395
1layhid5.to.Output      -0.528461434
1layhid6.to.Output       2.501291588
1layhid7.to.Output       1.254686057
1layhid8.to.Output      -0.404215935
1layhid9.to.Output      -1.122936106
1layhid10.to.Output     -0.946436306

attr(,"class")
[1] "nn"
> plot(nn)
> 
> results <- compute(nn, testdata)
> ls(results)
[1] "net.result" "neurons"   
> comparison <- data.frame(actual=testdata[,2], prediction=results$net.result)
> comparison
        actual  prediction
1  0.778421341 0.759190693
2  0.673665306 0.672453266
3  0.219964559 0.222831043
4  0.063998505 0.061092317
5  0.027503192 0.024171014
6  0.589389911 0.596374180
7  0.062602555 0.059654652
8  1.000000000 0.913271943
9  0.074636058 0.072072046
10 0.005777271 0.004997875
11 0.575745925 0.583574654
12 0.162921435 0.163607067
13 0.219203617 0.222040321
14 0.899113415 0.847910347
15 0.014700219 0.012163871
> install.packages("neuralnet")
Warning in install.packages :
  pakiet ‘neuralnet’ jest w użyciu i nie zostanie zainstalowany
> 